/**
 * Highlight redaction suggestions in the comment text
 *
 * @param {string} text
 * @param {import('@azure/ai-text-analytics').PiiEntity[]} entities
 * @returns {string} text with <mark> tags
 */
export function highlightRedactionSuggestions(text, entities) {
	let highlighted = text;
	// reverse order so that the offsets are still valid
	for (let i = entities.length - 1; i >= 0; i--) {
		const entity = entities[i];
		highlighted =
			highlighted.substring(0, entity.offset) +
			'<mark>' +
			entity.text +
			'</mark>' +
			highlighted.substring(entity.offset + entity.length);
	}
	return highlighted;
}

export const REDACTION_CATEGORIES = Object.freeze([
	'ABARoutingNumber',
	'Address',
	'Age',
	'All',
	'ARNationalIdentityNumber',
	'ATIdentityCard',
	'ATTaxIdentificationNumber',
	'ATValueAddedTaxNumber',
	'AUBankAccountNumber',
	'AUBusinessNumber',
	'AUCompanyNumber',
	'AUDriversLicenseNumber',
	'AUMedicalAccountNumber',
	'AUPassportNumber',
	'AUTaxFileNumber',
	'AzureDocumentDBAuthKey',
	'AzureIaasDatabaseConnectionAndSQLString',
	'AzureIoTConnectionString',
	'AzurePublishSettingPassword',
	'AzureRedisCacheString',
	'AzureSAS',
	'AzureServiceBusString',
	'AzureStorageAccountGeneric',
	'AzureStorageAccountKey',
	'BENationalNumber',
	'BENationalNumberV2',
	'BEValueAddedTaxNumber',
	'BGUniformCivilNumber',
	'BrcpfNumber',
	'BRLegalEntityNumber',
	'BRNationalIdrg',
	'CABankAccountNumber',
	'CADriversLicenseNumber',
	'CAHealthServiceNumber',
	'CAPassportNumber',
	'CAPersonalHealthIdentification',
	'CASocialInsuranceNumber',
	'CHSocialSecurityNumber',
	'CLIdentityCardNumber',
	'CNResidentIdentityCardNumber',
	'CreditCardNumber',
	'CYIdentityCard',
	'CYTaxIdentificationNumber',
	'CZPersonalIdentityNumber',
	'CZPersonalIdentityV2',
	'Date',
	'DEDriversLicenseNumber',
	'Default',
	'DEIdentityCardNumber',
	'DEPassportNumber',
	'DETaxIdentificationNumber',
	'DEValueAddedNumber',
	'DKPersonalIdentificationNumber',
	'DKPersonalIdentificationV2',
	'DrugEnforcementAgencyNumber',
	'EEPersonalIdentificationCode',
	'Email',
	'Esdni',
	'ESSocialSecurityNumber',
	'ESTaxIdentificationNumber',
	'EUDebitCardNumber',
	'EUDriversLicenseNumber',
	'EugpsCoordinates',
	'EUNationalIdentificationNumber',
	'EUPassportNumber',
	'EUSocialSecurityNumber',
	'EUTaxIdentificationNumber',
	'FIEuropeanHealthNumber',
	'FINationalID',
	'FINationalIDV2',
	'FIPassportNumber',
	'FRDriversLicenseNumber',
	'FRHealthInsuranceNumber',
	'FRNationalID',
	'FRPassportNumber',
	'FRSocialSecurityNumber',
	'FRTaxIdentificationNumber',
	'FRValueAddedTaxNumber',
	'GRNationalIDCard',
	'GRNationalIDV2',
	'GRTaxIdentificationNumber',
	'HKIdentityCardNumber',
	'HRIdentityCardNumber',
	'HRNationalIDNumber',
	'HRPersonalIdentificationNumber',
	'HRPersonalIdentificationOIBNumberV2',
	'HUPersonalIdentificationNumber',
	'HUTaxIdentificationNumber',
	'HUValueAddedNumber',
	'IDIdentityCardNumber',
	'IEPersonalPublicServiceNumber',
	'IEPersonalPublicServiceNumberV2',
	'ILBankAccountNumber',
	'ILNationalID',
	'INPermanentAccount',
	'InternationalBankingAccountNumber',
	'INUniqueIdentificationNumber',
	'IPAddress',
	'ITDriversLicenseNumber',
	'ITFiscalCode',
	'ITValueAddedTaxNumber',
	'JPBankAccountNumber',
	'JPDriversLicenseNumber',
	'JPMyNumberCorporate',
	'JPMyNumberPersonal',
	'JPPassportNumber',
	'JPResidenceCardNumber',
	'JPResidentRegistrationNumber',
	'JPSocialInsuranceNumber',
	'KRResidentRegistrationNumber',
	'LTPersonalCode',
	'LUNationalIdentificationNumberNatural',
	'LUNationalIdentificationNumberNonNatural',
	'LVPersonalCode',
	'MTIdentityCardNumber',
	'MTTaxIDNumber',
	'MYIdentityCardNumber',
	'NLCitizensServiceNumber',
	'NLCitizensServiceNumberV2',
	'NLTaxIdentificationNumber',
	'NLValueAddedTaxNumber',
	'NOIdentityNumber',
	'NZBankAccountNumber',
	'NZDriversLicenseNumber',
	'NZInlandRevenueNumber',
	'NZMinistryOfHealthNumber',
	'NZSocialWelfareNumber',
	'Organization',
	'Person',
	'PhoneNumber',
	'PHUnifiedMultiPurposeIDNumber',
	'PLIdentityCard',
	'PLNationalID',
	'PLNationalIDV2',
	'PLPassportNumber',
	'PlregonNumber',
	'PLTaxIdentificationNumber',
	'PTCitizenCardNumber',
	'PTCitizenCardNumberV2',
	'PTTaxIdentificationNumber',
	'ROPersonalNumericalCode',
	'RUPassportNumberDomestic',
	'RUPassportNumberInternational',
	'SANationalID',
	'SENationalID',
	'SENationalIDV2',
	'SEPassportNumber',
	'SETaxIdentificationNumber',
	'SGNationalRegistrationIdentityCardNumber',
	'SITaxIdentificationNumber',
	'SIUniqueMasterCitizenNumber',
	'SKPersonalNumber',
	'SQLServerConnectionString',
	'SwiftCode',
	'THPopulationIdentificationCode',
	'TRNationalIdentificationNumber',
	'TWNationalID',
	'TWPassportNumber',
	'TWResidentCertificate',
	'UAPassportNumberDomestic',
	'UAPassportNumberInternational',
	'UKDriversLicenseNumber',
	'UKElectoralRollNumber',
	'UKNationalHealthNumber',
	'UKNationalInsuranceNumber',
	'UKUniqueTaxpayerNumber',
	'URL',
	'USBankAccountNumber',
	'USDriversLicenseNumber',
	'USIndividualTaxpayerIdentification',
	'USSocialSecurityNumber',
	'UsukPassportNumber',
	'ZAIdentificationNumber'
]);
