{% extends "views/layouts/main.njk" %}

{% from "govuk/components/table/macro.njk" import govukTable %}

{% macro makeHtml(text, url) %}
  <a href="{{ url }}">{{ text }}</a>
{% endmacro %}

{% block pageContent %}
  {% for items in data %}
  {% set rowData = items.rowData %}
    {%- if rowData | length > 0 -%}

      {% set rows = [] %}
      {% for item in rowData %}
        {% set row = [
          {
            html: makeHtml(item.name, item['@microsoft.graph.downloadUrl'])
          }, {
            text: item.createdBy.user.displayName
          }, {
            text: item.createdDateTime
          }
        ] %}
        {% set rows = rows.concat([row]) %}
      {% endfor %}

      {{ govukTable({
        caption: items.title,
        captionClasses: "govuk-table__caption--m",
        firstCellIsHeader: true,
        head: [
          {
            text: "Name"
          },
          {
            text: "Created by"
          },
          {
            text: "Created date"
          }
        ],
        rows: rows
      }) }}
    {%- endif -%}
  {% endfor %}
{% endblock %}